{
    "List the total number of customers and suppliers in each nation. Order by nation name": {
        "context_id": null,
        "similar_queries": "1. Count customers and suppliers by region:\n\n# Count customers and suppliers by region\nnation_counts = regions.CALCULATE(\n    region_name=name,\n    n_customers=COUNT(nations.customers),\n    n_suppliers=COUNT(nations.suppliers)\n)"
    },
    "Find the top 5 nations with the highest number of orders placed by their customers in 1995.": {
        "context_id": null,
        "similar_queries": "1. Top 5 nations by average order value in 1995:\n\norders_in_1995= customers.orders.WHERE(YEAR(order_date) == 1995)\n\ntop_5_nations = nations.CALCULATE(\n    nation_name=name,\n    average_orders= AVG(orders_in_1995), \n    order_count=COUNT(orders_in_1995)\n).TOP_K(5, by=average_orders.DESC())"
    },
    "Find the region name with the highest total order value in 1996. The total order value is defined as potential revenue, defined as the sum of extended_price * (1 - discount)": {
        "context_id": null,
        "similar_queries": null
    },
    "Find the top 3 regions with the most distinct customers": {
        "context_id": "10. Functions to use NDISTINCT, TOP_K",
        "similar_queries": "1. Find the top 10 with the most distinct suppliers\n\ntop_regions = regions.CALCULATE(\n    region_name=name,\n    suppliers_count=NDISTINCT(nations.suppliers.key)\n).TOP_K(10, by=customer_count.DESC())"
    },
    "Find the names of all customers and number of orders placed in 1995 in Europe who have an account balance greater than $700 and placed at least one order in 1995. Sorted in descending order by the number of orders. Do not use HAS function": {
        "context_id": null,
        "similar_queries": null
    },
    "Find suppliers in each nation who have an availqty of more than 1000 units of parts with 'BRASS' in their type. List the supplier name, nation name, and the sum of the parts supplied.": {
        "context_id": null,
        "similar_queries": null
    },
    "Find the parts that are supplied by at least five different nations. Show the part name and the count of distinct nations that supply each part": {
        "context_id": "10. You must use PARTITION and NDISTINCT to solve the query",
        "similar_queries": null
    },
    "Which 10 customers purchased the highest quantity of products with 'green' in the product name during 1998? Provide their names, address, and the total quantity ordered.": {
        "context_id": null,
        "similar_queries": null
    },
    "Which is the average discount applied on orders for each market segment? Sorted in descending order": {
        "context_id": "10. As recommendation use the PARTITION",
        "similar_queries": null
    },
    "What were the 20 most popular products (parts) within each market segment in 1998?": {
        "context_id": "10. You must use PARTITION and RANKING",
        "similar_queries": null
    },
    "Retrieves the top 3 suppliers with the highest total sales for each region": {
        "context_id": "10. You must use RANKING",
        "similar_queries": "Top 5 Customers with Highest Purchase Value by Nation\n\nresult = nations.CALCULATE(nation_name= name).customers.CALCULATE(nation_name= nation_name, cust_name= name, total_sales= SUM(orders.lines.extended_price  * (1 - orders.lines.discount))).WHERE(RANKING(by=total_sales.DESC(), levels=1, allow_ties=True) <=5)"
    }
}