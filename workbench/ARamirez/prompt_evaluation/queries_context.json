{
    "List the total number of customers and suppliers in each nation. Order by nation name": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, SORTING, AGGREGATION, EXAMPLE_QUERIES",
        "similar_queries": "1. Count customers and suppliers by region:\n\n# Count customers and suppliers by region\nnation_counts = regions.CALCULATE(\n    region_name=name,\n    n_customers=COUNT(nations.customers),\n    n_suppliers=COUNT(nations.suppliers)\n)"
    },
    "Find the top 5 nations with the highest number of orders placed by their customers in 1995.": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, WHERE, SORTING, DATETIME_FUNCTIONS, EXAMPLE_QUERIES",
        "similar_queries": "1. Top 5 nations by average order value in 1995:\n\norders_in_1995= customers.orders.WHERE(YEAR(order_date) == 1995)\n\ntop_5_nations = nations.CALCULATE(\n    nation_name=name,\n    average_orders= AVG(orders_in_1995), \n    order_count=COUNT(orders_in_1995)\n).TOP_K(5, by=average_orders.DESC())"
    },
    "Find the region name with the highest total order value in 1996. The total order value is defined as potential revenue, defined as the sum of extended_price * (1 - discount)": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, WHERE, SORTING, BINARY_OPERATORS, DATETIME_FUNCTIONS, EXAMPLE_QUERIES",
        "similar_queries": null
    },
    "Find the top 3 regions with the most distinct customers": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, SORTING, AGGREGATION, EXAMPLE_QUERIES",
        "similar_queries": "1. Find the top 10 with the most distinct suppliers\n\ntop_regions = regions.CALCULATE(\n    region_name=name,\n    suppliers_count=NDISTINCT(nations.suppliers.key)\n).TOP_K(10, by=customer_count.DESC())"
    },
    "Find the names of all customers and number of orders placed in 1995 in Europe who have an account balance greater than $700 and placed at least one order in 1995. Sorted in descending order by the number of orders. Do not use HAS function": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, WHERE, SORTING, AGGREGATION, COMPARISON_OPERATORS, DATETIME_FUNCTIONS, EXAMPLE_QUERIES",
        "similar_queries": null
    },
    "Find suppliers in each nation who have an availqty of more than 1000 units of parts with 'BRASS' in their type. List the supplier name, nation name, and the sum of the parts supplied.": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, WHERE, SORTING, AGGREGATION, COMPARISON_OPERATORS, STRING_FUNCTIONS, EXAMPLE_QUERIES",
        "similar_queries": null
    },
    "Find parts that are supplied by at least five different nations. Show the part name and the count of distinct nations that supply each part": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, WHERE, SORTING, AGGREGATION, COMPARISON_OPERATORS, PARTITION, EXAMPLE_QUERIES",
        "similar_queries": null
    },
    "Which 10 customers purchased the highest quantity of products with 'green' in the product name during 1998? Provide their names, address, and the total quantity ordered.": {
        "context_id": "Use the right functions from the following sections: COLLECTIONS_&_SUB-COLLECTIONS, CALCULATE_EXPRESSIONS, WHERE, SORTING, AGGREGATION, COMPARISON_OPERATORS, STRING_FUNCTIONS, EXAMPLE_QUERIES, BINARY_OPERATORS, DATETIME_FUNCTIONS",
        "similar_queries": null
    },
    "Which is the average discount applied on orders for each market segment? Sorted in descending order": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "SORTING.md",
            "AGGREGATION.md",
            "EXAMPLE_QUERIES.md",
            "PARTITION.md"
        ],
        "similar_queries":null
    },
    "What were the 20 most popular products (parts) within each market segment in 1998?": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "AGGREGATION.md",
            "BINARY_OPERATORS.md",
            "COMPARISON_OPERATORS.md",
            "WINDOW_FUNCTIONS.md",
            "DATETIME_FUNCTIONS.md"
        ],
        "similar_queries":null
    },
    "Retrieves the top 3 suppliers with the highest total sales for each region": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "AGGREGATION.md",
            "BINARY_OPERATORS.md",
            "COMPARISON_OPERATORS.md",
            "WINDOW_FUNCTIONS.md"
        ],
        "similar_queries":null
    },
    "For each European country, list the number of customers and the number of orders they placed in 1995, including customers who didn't place any orders that year.": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "AGGREGATION.md",
            "DATETIME_FUNCTIONS.md",
            "EXAMPLE_QUERIES.md"
        ],
        "similar_queries":null
    },
    "Retrieve the customer name of the customers who placed more orders in 1995 than in 1994": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "AGGREGATION.md",
            "DATETIME_FUNCTIONS.md",
            "EXAMPLE_QUERIES.md"
        ],
        "similar_queries":null
    },
    "Which is the average order value per Nation? List the nation name and average order value. The order value is defined as extended_price * quantity": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "AGGREGATION.md",
            "BINARY_OPERATORS.md",
            "COMPARISON_OPERATORS.md",
            "EXAMPLE_QUERIES.md"
        ],
        "similar_queries":null
    },
    "What 3 product brands saw the largest positive change in quantity sold from 1995 to 1996.": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "AGGREGATION.md",
            "EXAMPLE_QUERIES.md",
            "CONDITIONAL.md",
            "PARTITION.md",
            "SORTING.md"
        ],
        "similar_queries":null
    },
    "What is the total revenue generated by each customer in 1994? Sorted by total revenue in descending order. The total revenue value is defined as the sum of extended_price * (1 - discount) What is the total revenue generated by each customer in 1994? The total revenue value is defined as the sum of extended_price * (1 - discount). Return the customer key, customer name and total revenue": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "SORTING.md",
            "AGGREGATION.md",
            "BINARY_OPERATORS.md",
            "COMPARISON_OPERATORS.md",
            "EXAMPLE_QUERIES.md"
        ],
        "similar_queries":null
    },
    "Find all customers whose name ends with a zero and are in the 30-lowest account balances. Show the customer key, name and account balance": {
        "context_id": [
            "COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md",
            "WHERE.md",
            "SORTING.md",
            "STRING_FUNCTIONS.md"
        ],
        "similar_queries":null
    },
    "For each of the 5 largest part sizes, find the part of that size with the largest retail price": {
        "context_id": ["COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md","EXAMPLE_QUERIES.md"],
        "similar_queries":null    
    },
    "For each region, calculate the average percentage of purchases made from suppliers in that region belonging to the most common part type shipped from the supplier region to the customer region, averaging across all customer region. Only considers lineitems from June of 1992 where the container is small. To know if a container is small the container should start with SM": {
        "context_id": ["COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md","EXAMPLE_QUERIES.md"],
        "similar_queries":null
    },
    "Break down how many customers, by country code of their phone number (only including customers from certain country codes), have not placed an order but have an account balance that is above the average for all positive account balances of such customers. Also include the total balance for all such customers for each country code. The country codes to include are 13, 23, 29, 30, 18 and 17.": {
        "context_id": ["COLLECTIONS_&_SUB-COLLECTIONS.md",
            "CALCULATE_EXPRESSIONS.md","EXAMPLE_QUERIES.md", "SLICING.md"],
        "similar_queries":null
    }
}